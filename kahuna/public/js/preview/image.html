<div class="preview image-actions-container"
     title="{{image.data.metadata.description || image.data.metadata.title}}">

    <ul class="image-actions" ng:if="! selectionMode">
        <li>
            <a class="image-action image-action--first"
               target="_blank"
               title="Pop out"
               ng:href="/images/{{image.data.id}}"
               gr:track-click="Popout button">◹</a>
        </li>

        <li>
            <a class="image-action"
               title="crop"
               ng:if="image.data.valid"
               ui:sref="crop({ imageId: image.data.id })">✂</a>
        </li>
        <li>
            <ng:transclude></ng:transclude>
        </li>
    </ul>

    <a ng:if="! selectionMode" class="preview__link"
       ui:sref="image({imageId: image.data.id})"
       ui:drag-data="{{image | asImageDragData}}">
       <div class="preview__fade"></div>
       <img class="preview__image"
            ng:src="{{image.data.thumbnail | assetFile}}"
            gr:image-fade-on-load />
    </a>

    <span  ng:if="selectionMode" class="preview__no-link">
        <div class="preview__fade"></div>
        <img class="preview__image"
             ng:src="{{image.data.thumbnail | assetFile}}"
             gr:image-fade-on-load />
    </span>

    <div class="preview__info" ng:if="! hideInfo">
        <ui-labeller-compact class="preview__labeller"
                             image="image"
                             disabled="selectionMode"></ui-labeller-compact>

        <p class="preview__description">{{image.data.metadata.description || image.data.metadata.title}}</p>
    </div>

    <div class="preview__bottom-bar bottom-bar">
        <div class="bottom-bar__meta">
            <span ng:if="ctrl.displayAsRelative(image.data.uploadTime)"
                  class="preview__upload-time">
                {{ctrl.relativeFormat(image.data.uploadTime)}}
            </span>

            <span ng:if="!ctrl.displayAsRelative(image.data.uploadTime)"
                class="preview__upload-time">
                {{image.data.uploadTime | date:'d/M/yy'}} at {{image.data.uploadTime | date:'HH:mm'}}
            </span>

            <span class="bottom-bar__meta-item preview__has-crops"
                  title="this image has crops"
                  ng:if="image | hasExportsOfType:'crop'">

                <gr-icon gr-small>crop</gr-icon>
            </span>
        </div>
        <div class="bottom-bar__actions">

            <ui-archiver
                class="bottom-bar__action"
                image="image"
                disabled="selectionMode"></ui-archiver>

            <div class="preview__cost bottom-bar__action" ng:switch="image.data.cost">
                <div ng:switch-when="pay"
                     class="cost cost--pay">
                    pay
                </div>

                <div ng:switch-when="conditional"
                     class="cost cost--conditional"
                     title="{{image.data.usageRights.restrictions}}">
                     <!-- As `conditional` can only be set with usageRights, let's
                     just assume it's here. We might need to revisit this. -->
                    restricted
                </div>
            </div>
        </div>
    </div>
</div>
