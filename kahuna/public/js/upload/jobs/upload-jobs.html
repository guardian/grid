<table class="jobs">
    <tbody ng:init="">
        <tr ng:repeat="job in jobs">
            <td class="job-info job-info--thumbnail">
                <a ui:sref="image({imageId: job.id})"
                   ng:if="job.thumbnail">
                    <img ng:src="{{job.thumbnail | assetFile}}"
                         class="job-info--thumbnail__image" />
                </a>
            </td>
            <td class="job-info job-info--file">
                <div>
                    <span class="job-status {{'job-status--' + job.status}}">
                        {{job.status}}
                    </span>
                </div>
                <div ng:if="job.status == 'upload-error'">
                    {{job.error}}
                </div>
                <div class="job-file">
                    <div class="job-file__name">{{job.name}}</div>
                    <div class="job-file__size">{{job.size | asFileSize}}</div>
                </div>
            </td>
            <td class="job-info job-info--editor">
                <div ng:if="job.image">
                    <ui-required-metadata-editor initial="job.image.data.metadata"
                                                 override-resource="job.image.data.userMetadata.data.metadata"
                                                 on-update="overrideMetadata(job, metadata)"
                    ></ui-required-metadata-editor>

                    <ui-labeller class="jobs-labeller"
                                 labels="job.image.data.userMetadata.data.labels">
                    </ui-labeller>

                    <!-- TODO: find a more efficient way of of doing `jobsExcept` -->
                    <ui-edit-applicator ng:if="job.image"
                                        give-this="uploadJobsCtrl.getLabelsArrFrom(job.image)"
                                        to-these="uploadJobsCtrl.getAllEditsOfType('labels', uploadJobsCtrl.jobsExcept(job))"
                                        and-then="uploadJobsCtrl.updateLabels(uploadJobsCtrl.jobsExcept(job))">
                    </ui-edit-applicator>
                </div>
            </td>
        </tr>
    </tbody>
</table>
