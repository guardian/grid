<div class="crop-image">
    <div class="top-bar-wrapper">
        <div class="top-bar">
            <div class="top-bar__nav">
                <a class="top-bar__item top-bar__item--first"
                    ui:sref="image({ imageId: image.data.id })">← cancel</a>
            </div>

            <div class="top-bar__actions">
                <div class="top-bar__item">{{ imageCropCtrl.cropSize() }}</div>

                <label class="top-bar__item">
                    <input type="radio" ng:model="imageCropCtrl.aspect" value="{{landscapeRatio}}" />
                    landscape
                </label>

                <label class="top-bar__item">
                    <input type="radio" ng:model="imageCropCtrl.aspect" value="{{portraitRatio}}" />
                    portrait
                </label>

                <label class="top-bar__item">
                    <input type="radio" ng:model="imageCropCtrl.aspect" value="{{freeRatio}}" />
                    free-form
                </label>
                <div class="top-bar__item">
                    <button class="button"
                            type="button"
                            ng:show="!imageCropCtrl.cropSizeWarning()"
                            ng:click="crop()"
                            ng:disabled="cropping">
                            crop<span ng:show="cropping">ping…</span></button>

                    <button class="button button--warning"
                            ng:show="imageCropCtrl.cropSizeWarning()"
                            ng:click="preCrop()"
                            ng:disabled="cropping">
                            crop<span ng:show="cropping">ping…</span></button>
                    </button>
                </div>
            </div>
            <ui-user-actions></ui-user-actions>
        </div>
    </div>

    <div class="errors">
        <div class="error" ng:show="promptToCrop">
            This crop is very small and will result in a low-quality image. Are you sure you want to proceed?
            <div class="error__buttons">
                <button class="error__button button-shy"
                    ng:click="promptToCrop = false"
                    ng:disabled="cropping">
                    back to crop
                </button>

                <button class="error__button button"
                    ng:click="crop()"
                    ng:disabled="cropping">
                    <span ng:show="cropping">cropping</span>
                    <span ng:hide="cropping">complete this crop</span>
                </button>
            </div>
        </div>
    </div>

    <div class="easel" ng:if="image.data">
        <div class="easel__canvas">
            <img class="easel__image"
                 ng:src="{{optimisedImageUri}}"
                 ui:crop-box="coords"
                 ui:crop-box-original-width="image.data.source.dimensions.width"
                 ui:crop-box-original-height="image.data.source.dimensions.height"
                 ui:crop-box-aspect="imageCropCtrl.aspect"
                 ui:crop-box-background-opacity="0.3"

                 grid:track-image="image"
                 grid:track-image-location="original-cropping"
                 grid:track-image-loadtime />
        </div>
    </div>
</div>
